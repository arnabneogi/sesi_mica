From af71bfa63c59cbe14d46767033e5baf17c37401d Mon Sep 17 00:00:00 2001
From: Robert Horlings <robert@isdat.nl>
Date: Wed, 20 Aug 2014 11:34:51 +0200
Subject: [PATCH] Added dataset name to XML export

---
 .../mica_opal/mica_opal_view/ServicesOpalFormatter.inc  | 17 +++++++----------
 1 file changed, 7 insertions(+), 10 deletions(-)

diff --git a/src/main/drupal/modules/mica/extensions/mica_opal/mica_opal_view/ServicesOpalFormatter.inc b/src/main/drupal/modules/mica/extensions/mica_opal/mica_opal_view/ServicesOpalFormatter.inc
index 5749fe1..1cfea6e 100644
--- a/src/main/drupal/modules/mica/extensions/mica_opal/mica_opal_view/ServicesOpalFormatter.inc
+++ b/src/main/drupal/modules/mica/extensions/mica_opal/mica_opal_view/ServicesOpalFormatter.inc
@@ -88,7 +88,10 @@ class ServicesOpalFormatter implements ServicesFormatterInterface {
     }
     $this->doc->appendChild($this->doc->createComment($comment));
 
-    $opal = $this->doc->appendChild($this->doc->createElement('org.obiba.magma.views.View'));
+    $topnode = $this->doc->createElement('org.obiba.magma.views.View');
+    $topnode->setAttribute( 'name', check_plain($dataset_name));
+    $opal = $this->doc->appendChild($topnode);
+
     $select = $opal->appendChild($this->doc->createElement('select'));
     $select->setAttribute('class', 'org.obiba.magma.views.support.NoneClause');
 
-- 
1.9.1

